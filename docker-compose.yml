version: "3"
services:
  millicord:
    build: .
    container_name: millicord
    volumes:
      - ./:/millicord.py
    working_dir: /millicord.py
    tty: true
    command: >
      bash -c "pipenv lock -r > /tmp/requirements.txt &&
      pip install -r /tmp/requirements.txt &&
      pip install torchvision &&
      pip install https://download.pytorch.org/whl/cu100/torch-1.1.0-cp37-cp37m-linux_x86_64.whl &&
      rm -f requirements.txt &&
      /bin/bash"